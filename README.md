# Sec-Check

A VS Code Copilot toolkit for scanning code for malicious patterns before running it locally.

## What It Does

Sechek provides a custom Copilot agent and security scanning skills to detect dangerous patterns in codeâ€”credential theft, reverse shells, backdoors, and supply chain attacks. Use it to review scripts from the internet or untrusted sources before execution.

âš ï¸ **Warning**: This tool catches common red flags, not sophisticated attacks. Always use manual review and sandboxing for high-risk code.

---

## Components

### ğŸ¤– Custom Agent

**`@sechek.security-scanner`** â€” Malicious Code Scanner Agent

Deep security analysis with pattern detection and remediation guidance. Detects:
- Data exfiltration and credential theft
- Reverse shells and backdoors
- Persistence mechanisms (cron, registry)
- Obfuscated payloads (base64, eval)
- System destruction patterns

Can operate standalone or use security scanning tools (Bandit, GuardDog, ShellCheck, Graudit) when available.

---

### ğŸ”§ Security Skills

Skills teach Copilot how to use specific security tools:

| Skill | Purpose | Use For |
|-------|---------|---------|
| **bandit-security-scan** | Python AST-based security analysis | Python code vulnerabilities, dangerous functions (eval, exec, pickle), SQL injection |
| **guarddog-security-scan** | Supply chain & malware detection | Dependencies (`requirements.txt`, `package.json`), typosquatting, malicious packages |
| **shellcheck-security-scan** | Shell script static analysis | Bash/sh scripts, command injection, unquoted variables |
| **graudit-security-scan** | Multi-language pattern matching | Quick scans on unknown codebases, secrets detection, 15+ languages |

---

### ğŸ“ Custom Prompts

| Prompt | When to Use |
|--------|-------------|
| **`/sechek.tools-advisor`** | Get recommendations on which tools to run based on your codebase |
| **`/sechek.tools-scan`** | Execute security tools and save results to `tools-audit.md` |
| **`/sechek.security-scan`** | Full workspace scan with the security scanner agent |
| **`/sechek.security-scan-quick`** | Fast scan for malicious patterns, exfiltration, reverse shells |
| **`/sechek.security-scan-python`** | Python-focused scan using Bandit and GuardDog |
| **`/sechek.security-scan-shell`** | Shell script scan using ShellCheck and Graudit |
| **`/sechek.security-scan-supply-chain`** | Scan dependencies for supply chain attacks |
| **`/sechek.security-scan-precommit`** | Pre-commit check for secrets and vulnerabilities |
| **`/create-security-skill`** | Create a new security scanning skill from tool documentation |

---

## Quick Start

### Option 1: Full Scan
```
/sechek.security-scan
```
Runs comprehensive analysis using available tools and pattern detection.

### Option 2: Targeted Scans
```
/sechek.security-scan-python       # Python code
/sechek.security-scan-shell        # Shell scripts
/sechek.security-scan-supply-chain # Dependencies
```

### Option 3: Tool Workflow
```
/sechek.tools-advisor              # Get tool recommendations
/sechek.tools-scan ./src           # Run recommended tools
@sechek.security-scanner           # Deep analysis with tool output
```

---

## Output

| File | Generated By | Contents |
|------|--------------|----------|
| `.github/.audit/tools-audit.md` | `/sechek.tools-scan` | Raw tool output |
| `.github/.audit/scan-results.md` | `@sechek.security-scanner` | Analysis with findings & remediation |

---

## Repository Structure

```
.github/
â”œâ”€â”€ agents/
â”‚   â””â”€â”€ sechek.malicious-code-scanner.agent.md  # Security scanner agent
â”œâ”€â”€ skills/
â”‚   â”œâ”€â”€ bandit-security-scan/                   # Python security
â”‚   â”œâ”€â”€ guarddog-security-scan/                 # Supply chain
â”‚   â”œâ”€â”€ shellcheck-security-scan/               # Shell scripts
â”‚   â””â”€â”€ graudit-security-scan/                  # Multi-language
â”œâ”€â”€ prompts/                                    # Custom prompts
â””â”€â”€ .context/                                   # Attack patterns reference
research/
â””â”€â”€ techniques/                                 # Security research notes
```

---

## Limitations

- Pattern-based detection onlyâ€”may miss obfuscated or novel attacks
- No guarantee of safetyâ€”use as first-pass filter, not final decision
- Requires manual review for context-dependent vulnerabilities

For production or high-security environments, combine with professional security audits and isolated testing.
